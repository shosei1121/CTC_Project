{"version":3,"file":"auth-DZq4BhfS.js","sources":["../../src/js/auth/auth.js"],"sourcesContent":["import { signInWithPassword, signUp } from '../../services/local-storage.js';\nimport { connectMetaMask } from './web3-auth.js';\n\ndocument.addEventListener('DOMContentLoaded', () => {\n    const loginForm = document.getElementById('loginForm');\n    const signupForm = document.getElementById('signupForm');\n    const authTabs = document.querySelectorAll('.auth-tab');\n    const authMessage = document.getElementById('authMessage');\n    const metamaskButton = document.getElementById('metamaskButton');\n\n    // MetaMaskログイン\n    metamaskButton.addEventListener('click', async () => {\n        try {\n            showMessage('MetaMaskに接続中...', '');\n            await connectMetaMask();\n            showMessage('認証に成功しました！', 'success');\n            setTimeout(() => {\n                window.location.href = '/';\n            }, 1500);\n        } catch (error) {\n            console.error('MetaMask error:', error);\n            showMessage(error.message || 'MetaMask認証に失敗しました。', 'error');\n        }\n    });\n\n    // タブ切り替え\n    authTabs.forEach(tab => {\n        tab.addEventListener('click', () => {\n            authTabs.forEach(t => t.classList.remove('active'));\n            tab.classList.add('active');\n\n            const forms = document.querySelectorAll('.auth-form');\n            forms.forEach(form => form.classList.remove('active'));\n            \n            const targetForm = tab.getAttribute('data-tab') === 'login' ? loginForm : signupForm;\n            targetForm.classList.add('active');\n            \n            authMessage.textContent = '';\n            authMessage.className = 'auth-message';\n        });\n    });\n\n    // ログイン処理\n    loginForm.addEventListener('submit', async (e) => {\n        e.preventDefault();\n        \n        const email = document.getElementById('loginEmail').value;\n        const password = document.getElementById('loginPassword').value;\n\n        try {\n            showMessage('ログイン中...', '');\n            const { user } = await signInWithPassword({\n                email,\n                password\n            });\n\n            if (!user) throw new Error('ログインに失敗しました。');\n\n            showMessage('ログインに成功しました！', 'success');\n            setTimeout(() => {\n                window.location.href = '/';\n            }, 1500);\n        } catch (error) {\n            console.error('Login error:', error);\n            showMessage('ログインに失敗しました。メールアドレスとパスワードを確認してください。', 'error');\n        }\n    });\n\n    // 新規登録処理\n    signupForm.addEventListener('submit', async (e) => {\n        e.preventDefault();\n        \n        const username = document.getElementById('signupUsername').value;\n        const email = document.getElementById('signupEmail').value;\n        const password = document.getElementById('signupPassword').value;\n        const confirmPassword = document.getElementById('confirmPassword').value;\n\n        if (password !== confirmPassword) {\n            showMessage('パスワードが一致しません。', 'error');\n            return;\n        }\n\n        if (password.length < 6) {\n            showMessage('パスワードは6文字以上で入力してください。', 'error');\n            return;\n        }\n\n        try {\n            showMessage('アカウント作成中...', '');\n            const { user } = await signUp({\n                email,\n                password,\n                options: {\n                    data: {\n                        username: username\n                    }\n                }\n            });\n\n            if (!user) throw new Error('アカウント作成に失敗しました。');\n\n            showMessage('アカウントを作成しました！', 'success');\n            setTimeout(() => {\n                window.location.href = '/';\n            }, 1500);\n        } catch (error) {\n            console.error('Signup error:', error);\n            if (error.message.includes('User already registered')) {\n                showMessage('このメールアドレスは既に登録されています。', 'error');\n            } else {\n                showMessage('アカウント作成に失敗しました。', 'error');\n            }\n        }\n    });\n\n    function showMessage(message, type) {\n        authMessage.textContent = message;\n        authMessage.className = `auth-message ${type}`;\n    }\n});"],"names":["loginForm","signupForm","authTabs","authMessage","showMessage","connectMetaMask","error","tab","t","form","e","email","password","user","signInWithPassword","username","confirmPassword","signUp","message","type"],"mappings":"mGAGA,SAAS,iBAAiB,mBAAoB,IAAM,CAChD,MAAMA,EAAY,SAAS,eAAe,WAAW,EAC/CC,EAAa,SAAS,eAAe,YAAY,EACjDC,EAAW,SAAS,iBAAiB,WAAW,EAChDC,EAAc,SAAS,eAAe,aAAa,EAClC,SAAS,eAAe,gBAAgB,EAGhD,iBAAiB,QAAS,SAAY,CACjD,GAAI,CACAC,EAAY,kBAAmB,EAAE,EACjC,MAAMC,EAAiB,EACvBD,EAAY,aAAc,SAAS,EACnC,WAAW,IAAM,CACb,OAAO,SAAS,KAAO,GAC1B,EAAE,IAAI,CACV,OAAQE,EAAO,CACZ,QAAQ,MAAM,kBAAmBA,CAAK,EACtCF,EAAYE,EAAM,SAAW,qBAAsB,OAAO,CACtE,CACA,CAAK,EAGDJ,EAAS,QAAQK,GAAO,CACpBA,EAAI,iBAAiB,QAAS,IAAM,CAChCL,EAAS,QAAQM,GAAKA,EAAE,UAAU,OAAO,QAAQ,CAAC,EAClDD,EAAI,UAAU,IAAI,QAAQ,EAEZ,SAAS,iBAAiB,YAAY,EAC9C,QAAQE,GAAQA,EAAK,UAAU,OAAO,QAAQ,CAAC,GAElCF,EAAI,aAAa,UAAU,IAAM,QAAUP,EAAYC,GAC/D,UAAU,IAAI,QAAQ,EAEjCE,EAAY,YAAc,GAC1BA,EAAY,UAAY,cACpC,CAAS,CACT,CAAK,EAGDH,EAAU,iBAAiB,SAAU,MAAOU,GAAM,CAC9CA,EAAE,eAAgB,EAElB,MAAMC,EAAQ,SAAS,eAAe,YAAY,EAAE,MAC9CC,EAAW,SAAS,eAAe,eAAe,EAAE,MAE1D,GAAI,CACAR,EAAY,WAAY,EAAE,EAC1B,KAAM,CAAE,KAAAS,GAAS,MAAMC,EAAmB,CACtC,MAAAH,EACA,SAAAC,CAChB,CAAa,EAED,GAAI,CAACC,EAAM,MAAM,IAAI,MAAM,cAAc,EAEzCT,EAAY,eAAgB,SAAS,EACrC,WAAW,IAAM,CACb,OAAO,SAAS,KAAO,GAC1B,EAAE,IAAI,CACV,OAAQE,EAAO,CACZ,QAAQ,MAAM,eAAgBA,CAAK,EACnCF,EAAY,sCAAuC,OAAO,CACtE,CACA,CAAK,EAGDH,EAAW,iBAAiB,SAAU,MAAOS,GAAM,CAC/CA,EAAE,eAAgB,EAElB,MAAMK,EAAW,SAAS,eAAe,gBAAgB,EAAE,MACrDJ,EAAQ,SAAS,eAAe,aAAa,EAAE,MAC/CC,EAAW,SAAS,eAAe,gBAAgB,EAAE,MACrDI,EAAkB,SAAS,eAAe,iBAAiB,EAAE,MAEnE,GAAIJ,IAAaI,EAAiB,CAC9BZ,EAAY,gBAAiB,OAAO,EACpC,MACZ,CAEQ,GAAIQ,EAAS,OAAS,EAAG,CACrBR,EAAY,wBAAyB,OAAO,EAC5C,MACZ,CAEQ,GAAI,CACAA,EAAY,cAAe,EAAE,EAC7B,KAAM,CAAE,KAAAS,GAAS,MAAMI,EAAO,CAC1B,MAAAN,EACA,SAAAC,EACA,QAAS,CACL,KAAM,CACF,SAAUG,CAClC,CACA,CACA,CAAa,EAED,GAAI,CAACF,EAAM,MAAM,IAAI,MAAM,iBAAiB,EAE5CT,EAAY,gBAAiB,SAAS,EACtC,WAAW,IAAM,CACb,OAAO,SAAS,KAAO,GAC1B,EAAE,IAAI,CACV,OAAQE,EAAO,CACZ,QAAQ,MAAM,gBAAiBA,CAAK,EAChCA,EAAM,QAAQ,SAAS,yBAAyB,EAChDF,EAAY,wBAAyB,OAAO,EAE5CA,EAAY,kBAAmB,OAAO,CAEtD,CACA,CAAK,EAED,SAASA,EAAYc,EAASC,EAAM,CAChChB,EAAY,YAAce,EAC1Bf,EAAY,UAAY,gBAAgBgB,CAAI,EACpD,CACA,CAAC"}