(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(e){if(e.ep)return;e.ep=!0;const n=t(e);fetch(e.href,n)}})();const i={USERS:"users",PROFILES:"profiles",PRODUCTS:"products",CHANNELS:"channels",USER_NFTS:"user_nfts",TRANSACTIONS:"transactions",PURCHASED_NFTS:"purchased_nfts"},f={products:[{id:"1",name:"朝採れ野菜セットNFT",location:"長野県",price:5e4,rating:4.8,sales:120,image_url:"https://api.dicebear.com/7.x/shapes/svg?seed=vegetables1",description:"山田農園で朝採れた新鮮な季節の野菜をデジタルアートで表現。",channel_id:"1",sold:!1},{id:"2",name:"有機りんごNFT",location:"長野県",price:75e3,rating:4.5,sales:85,image_url:"https://api.dicebear.com/7.x/shapes/svg?seed=apple1",description:"無農薬で育てた蜜入りりんごの収穫の瞬間を切り取ったアート作品。",channel_id:"1",sold:!1},{id:"3",name:"山田農園の四季NFT",location:"長野県",price:45e3,rating:4.7,sales:150,image_url:"https://api.dicebear.com/7.x/shapes/svg?seed=seasons1",description:"一年を通じて変化する農園の風景を四季折々で表現。",channel_id:"1",sold:!1},{id:"4",name:"伝統野菜の物語NFT",location:"長野県",price:6e4,rating:4.6,sales:95,image_url:"https://api.dicebear.com/7.x/shapes/svg?seed=traditional1",description:"代々受け継がれてきた伝統野菜の栽培方法と歴史を表現。",channel_id:"1",sold:!1},{id:"5",name:"朝焼けの牧場NFT",location:"千葉県",price:55e3,rating:4.7,sales:110,image_url:"https://api.dicebear.com/7.x/shapes/svg?seed=sunrise1",description:"海辺の牧場で撮影された美しい朝焼けの風景。",channel_id:"2",sold:!1},{id:"6",name:"ジャージー牛の一日NFT",location:"千葉県",price:7e4,rating:4.6,sales:80,image_url:"https://api.dicebear.com/7.x/shapes/svg?seed=jersey1",description:"牧場のジャージー牛たちの日常を切り取った作品。",channel_id:"2",sold:!1},{id:"7",name:"海風と緑のハーモニーNFT",location:"千葉県",price:48e3,rating:4.8,sales:130,image_url:"https://api.dicebear.com/7.x/shapes/svg?seed=harmony1",description:"潮風に揺れる牧草地の美しい風景を表現。",channel_id:"2",sold:!1},{id:"8",name:"大地の恵みNFT",location:"北海道",price:65e3,rating:4.9,sales:140,image_url:"https://api.dicebear.com/7.x/shapes/svg?seed=harvest1",description:"広大な大地で育まれた作物の収穫風景。",channel_id:"3",sold:!1},{id:"9",name:"北の大地の物語NFT",location:"北海道",price:8e4,rating:4.8,sales:95,image_url:"https://api.dicebear.com/7.x/shapes/svg?seed=story1",description:"北海道の雄大な自然と農業の調和を表現。",channel_id:"3",sold:!1},{id:"10",name:"雪解けの春NFT",location:"北海道",price:58e3,rating:4.7,sales:115,image_url:"https://api.dicebear.com/7.x/shapes/svg?seed=spring1",description:"春を迎えた畑の目覚めを切り取った瞬間。",channel_id:"3",sold:!1}],channels:[{id:"1",name:"山田農園",image_url:"https://api.dicebear.com/7.x/avataaars/svg?seed=yamada",likes:15e3,is_live:!0,description:"代々続く有機農法にこだわる農園です。新鮮な野菜とともに、農園の四季折々の風景をNFTとして提供しています。",location:"長野県",specialties:["有機野菜","果物","山菜"],farming_style:"有機農法",established:"1950年"},{id:"2",name:"海辺の牧場",image_url:"https://api.dicebear.com/7.x/avataaars/svg?seed=umibe",likes:12e3,is_live:!1,description:"潮風と緑豊かな環境で育つ牧場の動物たちの日常をNFTに。自然との共生を大切にしています。",location:"千葉県",specialties:["乳製品","放牧卵","食肉"],farming_style:"放牧式",established:"1985年"},{id:"3",name:"緑の大地農場",image_url:"https://api.dicebear.com/7.x/avataaars/svg?seed=midori",likes:18e3,is_live:!0,description:"北海道の広大な大地で、自然と共に歩む農業を実践。四季折々の風景と収穫の喜びをNFTに込めています。",location:"北海道",specialties:["小麦","大豆","じゃがいも"],farming_style:"自然循環農法",established:"1975年"}]};function S(){Object.entries(i).forEach(([s,a])=>{localStorage.getItem(a)||localStorage.setItem(a,JSON.stringify(f[a.toLowerCase()]||[]))})}async function m({email:s,password:a}){const r=JSON.parse(localStorage.getItem(i.USERS)||"[]").find(e=>e.email===s&&e.password===a);if(!r)throw new Error("Invalid login credentials");return localStorage.setItem("currentUser",JSON.stringify(r)),{user:r}}async function h({email:s,password:a,options:t}){var l;const r=JSON.parse(localStorage.getItem(i.USERS)||"[]");if(r.some(c=>c.email===s))throw new Error("User already registered");const e={id:crypto.randomUUID(),email:s,password:a,...t==null?void 0:t.data};r.push(e),localStorage.setItem(i.USERS,JSON.stringify(r));const n=JSON.parse(localStorage.getItem(i.PROFILES)||"[]"),o={id:e.id,email:e.email,username:((l=t==null?void 0:t.data)==null?void 0:l.username)||`User${e.id.substring(0,8)}`,points:1e3,created_at:new Date().toISOString()};return n.push(o),localStorage.setItem(i.PROFILES,JSON.stringify(n)),{user:e}}async function N(){localStorage.removeItem("currentUser")}async function d(){const s=localStorage.getItem("currentUser");return s?{user:JSON.parse(s)}:{user:null}}async function O(){const{user:s}=await d();return s?JSON.parse(localStorage.getItem(i.PROFILES)||"[]").find(t=>t.id===s.id):null}async function _(s){const{user:a}=await d();if(!a)throw new Error("User not authenticated");const t=JSON.parse(localStorage.getItem(i.PROFILES)||"[]"),r=t.findIndex(e=>e.id===a.id);if(r===-1)throw new Error("Profile not found");return t[r]={...t[r],...s,updated_at:new Date().toISOString()},localStorage.setItem(i.PROFILES,JSON.stringify(t)),t[r]}async function u(){const s=JSON.parse(localStorage.getItem(i.PRODUCTS)||"[]"),a=JSON.parse(localStorage.getItem(i.PURCHASED_NFTS)||"[]");return s.map(t=>({...t,sold:a.includes(t.id)}))}async function I({sortBy:s,region:a}){let t=await u();if(t=t.filter(r=>!r.sold),a&&(t=t.filter(r=>r.location.toLowerCase().includes(a.toLowerCase()))),s)switch(s){case"name":t.sort((r,e)=>r.name.localeCompare(e.name));break;case"rating":t.sort((r,e)=>e.rating-r.rating);break;case"price":t.sort((r,e)=>r.price-e.price);break}return t}async function y(){return JSON.parse(localStorage.getItem(i.CHANNELS)||"[]")}async function w(s,a){const{user:t}=await d();if(!t)throw new Error("ユーザーが認証されていません。");const e=(await u()).find(c=>c.id===s);if(!e)throw new Error("商品が見つかりません。");if(e.sold)throw new Error("この商品は既に購入されています。");const n=JSON.parse(localStorage.getItem(i.TRANSACTIONS)||"[]");n.push({id:crypto.randomUUID(),user_id:t.id,type:a,amount:e.price,description:`${e.name}の購入`,created_at:new Date().toISOString()}),localStorage.setItem(i.TRANSACTIONS,JSON.stringify(n));const o=JSON.parse(localStorage.getItem(i.USER_NFTS)||"[]");o.push({id:crypto.randomUUID(),user_id:t.id,product_id:s,token_id:`NFT-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,purchased_at:new Date().toISOString(),products:e}),localStorage.setItem(i.USER_NFTS,JSON.stringify(o));const l=JSON.parse(localStorage.getItem(i.PURCHASED_NFTS)||"[]");if(l.push(s),localStorage.setItem(i.PURCHASED_NFTS,JSON.stringify(l)),a==="point"){const c=JSON.parse(localStorage.getItem(i.PROFILES)||"[]"),p=c.find(g=>g.id===t.id);p&&(p.points-=e.price,localStorage.setItem(i.PROFILES,JSON.stringify(c)))}return!0}async function T(){const{user:s}=await d();return s?JSON.parse(localStorage.getItem(i.USER_NFTS)||"[]").filter(t=>t.user_id===s.id):[]}async function E(){const{user:s}=await d();return s?JSON.parse(localStorage.getItem(i.TRANSACTIONS)||"[]").filter(t=>t.user_id===s.id):[]}export{y as a,I as b,T as c,E as d,h as e,u as f,O as g,d as h,S as i,N as j,w as p,m as s,_ as u};
//# sourceMappingURL=local-storage-BFjGCbUB.js.map
