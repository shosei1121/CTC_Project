import{i as v,g as L,f as k,a as C,p as I}from"./local-storage-BFjGCbUB.js";/* empty css               */import{c as B,s as h,u as w}from"./navigation-CvC7EUiU.js";async function P(){if(!await B()){window.location.href="/src/pages/auth.html";return}v(),h(),w()}P();let n=null,c=null,o=null;async function S(){if(c=await L(),c){const e=document.getElementById("currentPoints");e&&(e.textContent=c.points.toLocaleString())}}async function x(){const t=new URLSearchParams(window.location.search).get("id");if(!t){window.location.href="/src/pages/market.html";return}if(n=(await k()).find(a=>a.id===t),!n){window.location.href="/src/pages/market.html";return}if(document.getElementById("productImage").src=n.image_url,document.getElementById("productImage").alt=n.name,document.getElementById("productName").textContent=n.name,document.getElementById("productLocation").textContent=`üìç ${n.location}`,document.getElementById("productPrice").textContent=`¬•${n.price.toLocaleString()}`,document.getElementById("productRating").innerHTML=`
        <span class="stars">‚≠êÔ∏è ${n.rating}</span>
        <span class="sales">Ë≤©Â£≤Êï∞: ${n.sales}</span>
    `,document.getElementById("productDescription").textContent=n.description,o=(await C()).find(a=>a.id===n.channel_id),o){const a=document.getElementById("farmerInfo");if(a){document.getElementById("farmerAvatar").src=o.image_url,document.getElementById("farmerName").textContent=o.name,document.getElementById("farmerLocation").textContent=`üìç ${o.location}`,document.getElementById("farmerDescription").textContent=o.description,document.getElementById("farmerEstablished").textContent=o.established,document.getElementById("farmerStyle").textContent=o.farming_style,document.getElementById("farmerSpecialties").textContent=o.specialties.join("„ÄÅ");const d=a.querySelector(".farmer-header");d.style.cursor="pointer",d.addEventListener("click",()=>{window.location.href=`/src/pages/market.html?channel=${o.id}`});const i=document.getElementById("followButton");localStorage.getItem(`follow_${o.id}`)==="true"&&(i.classList.add("active"),i.textContent="„Éï„Ç©„É≠„Éº‰∏≠"),i.addEventListener("click",b)}}const r=document.getElementById("likeButton");r&&(localStorage.getItem(`like_${t}`)==="true"&&r.classList.add("active"),r.addEventListener("click",$))}function $(e){if(e.preventDefault(),e.stopPropagation(),!n)return;const t=n.id,l=localStorage.getItem(`like_${t}`)==="true";localStorage.setItem(`like_${t}`,!l),e.target.classList.toggle("active")}function b(e){if(e.preventDefault(),e.stopPropagation(),!o)return;const t=o.id,l=localStorage.getItem(`follow_${t}`)==="true";localStorage.setItem(`follow_${t}`,!l),e.target.classList.toggle("active"),e.target.textContent=l?"„Éï„Ç©„É≠„Éº":"„Éï„Ç©„É≠„Éº‰∏≠"}var s;(s=document.getElementById("backButton"))==null||s.addEventListener("click",()=>{window.history.back()});window.closeAllModals=function(){document.querySelectorAll(".modal").forEach(e=>{e.style.display="none"})};document.querySelectorAll(".close-btn").forEach(e=>{e.addEventListener("click",closeAllModals)});window.addEventListener("click",e=>{e.target.classList.contains("modal")&&closeAllModals()});var m;(m=document.getElementById("buyButton"))==null||m.addEventListener("click",()=>{document.getElementById("paymentModal").style.display="block"});var u;(u=document.getElementById("pointsPayment"))==null||u.addEventListener("click",async()=>{if(!(!n||!c))if(c.points>=n.price)try{await I(n.id,"point"),document.getElementById("paymentModal").style.display="none",document.getElementById("completionModal").style.display="block"}catch{alert("Ë≥ºÂÖ•„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ„ÇÇ„ÅÜ‰∏ÄÂ∫¶„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ„ÄÇ")}else alert("„Éù„Ç§„É≥„Éà„Åå‰∏çË∂≥„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ")});var g;(g=document.getElementById("creditPayment"))==null||g.addEventListener("click",()=>{document.getElementById("paymentModal").style.display="none",document.getElementById("creditCardModal").style.display="block"});var y;(y=document.getElementById("creditCardForm"))==null||y.addEventListener("submit",async e=>{if(e.preventDefault(),!!n)try{await I(n.id,"credit"),document.getElementById("creditCardModal").style.display="none",document.getElementById("completionModal").style.display="block"}catch{alert("Ê±∫Ê∏à„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ„ÇÇ„ÅÜ‰∏ÄÂ∫¶„ÅäË©¶„Åó„Åè„Å†„Åï„ÅÑ„ÄÇ")}});var p;(p=document.getElementById("cardNumber"))==null||p.addEventListener("input",e=>{let t=e.target.value.replace(/\D/g,"");t=t.replace(/(\d{4})(?=\d)/g,"$1 "),e.target.value=t});var f;(f=document.getElementById("expiryDate"))==null||f.addEventListener("input",e=>{let t=e.target.value.replace(/\D/g,"");t.length>=2&&(t=t.slice(0,2)+"/"+t.slice(2)),e.target.value=t});var E;(E=document.getElementById("cvv"))==null||E.addEventListener("input",e=>{e.target.value=e.target.value.replace(/\D/g,"")});async function M(){if(!await B()){window.location.href="/src/pages/auth.html";return}await Promise.all([S(),x()]),h(),w()}document.addEventListener("DOMContentLoaded",M);
//# sourceMappingURL=product-detail-8mfrOgv1.js.map
