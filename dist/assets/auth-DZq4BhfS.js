import{h as d,j as l}from"./local-storage-Bd1VrlsT.js";import{c as g}from"./web3-auth-wSHOpuom.js";document.addEventListener("DOMContentLoaded",()=>{const c=document.getElementById("loginForm"),m=document.getElementById("signupForm"),i=document.querySelectorAll(".auth-tab"),o=document.getElementById("authMessage");document.getElementById("metamaskButton").addEventListener("click",async()=>{try{e("MetaMaskに接続中...",""),await g(),e("認証に成功しました！","success"),setTimeout(()=>{window.location.href="/"},1500)}catch(t){console.error("MetaMask error:",t),e(t.message||"MetaMask認証に失敗しました。","error")}}),i.forEach(t=>{t.addEventListener("click",()=>{i.forEach(s=>s.classList.remove("active")),t.classList.add("active"),document.querySelectorAll(".auth-form").forEach(s=>s.classList.remove("active")),(t.getAttribute("data-tab")==="login"?c:m).classList.add("active"),o.textContent="",o.className="auth-message"})}),c.addEventListener("submit",async t=>{t.preventDefault();const r=document.getElementById("loginEmail").value,n=document.getElementById("loginPassword").value;try{e("ログイン中...","");const{user:s}=await d({email:r,password:n});if(!s)throw new Error("ログインに失敗しました。");e("ログインに成功しました！","success"),setTimeout(()=>{window.location.href="/"},1500)}catch(s){console.error("Login error:",s),e("ログインに失敗しました。メールアドレスとパスワードを確認してください。","error")}}),m.addEventListener("submit",async t=>{t.preventDefault();const r=document.getElementById("signupUsername").value,n=document.getElementById("signupEmail").value,s=document.getElementById("signupPassword").value,u=document.getElementById("confirmPassword").value;if(s!==u){e("パスワードが一致しません。","error");return}if(s.length<6){e("パスワードは6文字以上で入力してください。","error");return}try{e("アカウント作成中...","");const{user:a}=await l({email:n,password:s,options:{data:{username:r}}});if(!a)throw new Error("アカウント作成に失敗しました。");e("アカウントを作成しました！","success"),setTimeout(()=>{window.location.href="/"},1500)}catch(a){console.error("Signup error:",a),a.message.includes("User already registered")?e("このメールアドレスは既に登録されています。","error"):e("アカウント作成に失敗しました。","error")}});function e(t,r){o.textContent=t,o.className=`auth-message ${r}`}});
